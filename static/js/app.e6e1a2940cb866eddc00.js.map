{"version":3,"sources":["webpack:///./src/lib/protobufExport.js","webpack:///./src/proto/place.js","webpack:///./src/components/LoadingIcon.vue?d151","webpack:///./src/components/LoadingIcon.vue","webpack:///./src/lib/request.js","webpack:///./src/lib/postData.js","webpack:///./src/lib/appState.js","webpack:///./src/lib/BoundingBox.js","webpack:///./src/lib/Grid.js","webpack:///./src/config.js","webpack:///./src/lib/Progress.js","webpack:///src/components/FindPlace.vue","webpack:///./src/components/FindPlace.vue?82ae","webpack:///./src/components/FindPlace.vue","webpack:///./src/components/clickOutside.js","webpack:///src/components/EditableLabel.vue","webpack:///./src/components/EditableLabel.vue?e6d8","webpack:///./src/components/EditableLabel.vue","webpack:///src/components/ColorPicker.vue","webpack:///./src/components/ColorPicker.vue?8c27","webpack:///./src/components/ColorPicker.vue","webpack:///./src/lib/createScene.js","webpack:///./src/lib/getZazzleLink.js","webpack:///src/App.vue","webpack:///./src/App.vue?240b","webpack:///./src/App.vue","webpack:///./src/NoWebGL.vue?d991","webpack:///./src/NoWebGL.vue","webpack:///./src/main.js","webpack:///./src/lib/canvas2BlobPolyfill.js","webpack:///./src/lib/svgExport.js"],"names":["Pbf","require","place","module","exports","grid","nodes","ways","date","Date","toISOString","forEachElement","x","type","push","pbf","write","version","id","name","finish","read","end","readFields","_readField","tag","obj","readVarint","readString","node","pos","way","writeVarintField","writeStringField","i","length","writeMessage","lat","lon","readFloat","writeFloatField","readPackedVarint","writePackedVarint","LoadingIcon","render","_h","this","$createElement","_c","_self","staticClass","attrs","xmlns","viewBox","width","height","fill","opacity","d","_v","attributeName","from","to","dur","repeatCount","staticRenderFns","components_LoadingIcon","__webpack_require__","normalizeComponent","request","url","options","req","progress","on","onCancel","cancelDownload","promise_default","a","resolve","reject","XMLHttpRequest","notify","addEventListener","e","lengthComputable","loaded","total","percent","offCancel","isCancelled","status","response","responseType","JSON","parse","setTimeout","statusError","message","cancelled","open","method","headers","keys_default","forEach","key","setRequestHeader","send","body","abort","backends","queryState","createQueryState","useSearch","appState","drawLabels","backgroundColor","r","g","b","lineColor","labelColor","get","apply","arguments","set","unset","BBox","classCallCheck_default","minX","Infinity","minY","maxX","maxY","offset","xIn","yIn","undefined","Error","y","rect","addPoint","left","top","right","bottom","otherBBox","Grid","elements","bounds","BoundingBox","map_default","wayPointCount","projector","geoMercator","project","getProjector","leftTop","rightBottom","Math","abs","callback","positions","element","nodeIds","last","index","next","q","_ref","xyPoint","elementsOfOSMResponse","fromOSMResponse","setName","setId","gridInstance","center","cx","cy","scale","config","Progress","eventify","fire","off","FindPlace","components","data","hasValidArea","getCurrentAreaId","enteredInput","loading","lastCancel","suggestionsLoaded","stillLoading","error","hideInput","noRoads","clicked","showWarning","mainActionText","watch","mounted","$refs","input","focus","beforeDestroy","clearInterval","notifyStillLoading","methods","areaId","is_finite_default","parse_int_default","onSubmit","_this","cancelRequest","pickSuggestion","query","encodeURIComponent","fetch","then","json","filter","row","osm_type","map","display_name","osm_id","updateProgress","restartLoadingMonitor","round","formatNumber","suggestion","_this2","checkCache","catch","useOSM","_this3","setInterval","_this4","generateNewProgressToken","arrayBuffer","Uint8Array","byteArray","lib_Grid","fromPBF","$emit","_this5","postData","Content-type","serverIndex","fetchFrom","overpassUrl","handleError","err","postData_postData","osmResponse","console","finally","progressToken","cancel","lib_Progress","toString","replace","components_FindPlace","_vm","class","centered","_e","submit","$event","preventDefault","directives","rawName","value","expression","ref","placeholder","domProps","target","composing","href","click","_s","_m","_l","src_components_FindPlace","FindPlace_normalizeComponent","ssrContext","nodeList","ctx","startClick","seed","createDocumentHandler","el","binding","vnode","mouseup","mousedown","context","contains","popperElm","methodName","bindingFn","document","documentHandler","clickOutside","bind","update","unbind","len","splice","EditableLabel","props","ClickOutside","looseFocus","blur","components_EditableLabel","printable","src_components_EditableLabel","EditableLabel_normalizeComponent","ColorPicker","sketch-picker","vue_color_min","Object","showPicker","colors","hex","colorValue","panelLeft","panelTop","computed","pickerType","isTransparent","btnStyle","background","backgroundImage","backgroundPosition","backgroundSize","_colorValue","val","oldVal","updateColorObject","newVal","triggerRect","triggerButton","getBoundingClientRect","desiredLeft","desiredTop","window","innerHeight","max","innerWidth","hide","changeColor","rgba","color","colorObj","tinycolor_default","toHexString","hsl","toHsl","hsv","toHsv","toRgb","getAlpha","h","s","l","v","components_ColorPicker","style","model","$$v","src_components_ColorPicker","ColorPicker_normalizeComponent","wgl","createScene","canvas","scene","setClearColor","_grid$getProjectedRec","initialSceneSize","getProjectedRect","setViewBox","slowDownZoom","lines","WireCollection","forEachWay","add","createLinesCollection","appendChild","onKeyDown","onKeyUp","renderFrame","getProjectedVisibleRect","getSceneCoordinate","bottomRight","dispose","clear","removeEventListener","setLineColor","setBackground","shiftKey","getPanzoom","setZoomSpeed","imageUrl","productKinds","mug","generateZazzleLink","imageContent","toDataURL","form","FormData","append","Function","prototype","success","kind","productCode","getZazzleLink","link","log","lastGrid","App","placeFound","zazzleLink","generatingPreview","showPrintWindow","settingsOpen","isPowerMode","labelColorRGBA","toRGBA","togglePrintWindow","onGridLoaded","split","getCanvas","visibility","startOver","c","toFile","printableCanvas","getPrintableCanvas","fileName","getFileName","toBlob","blob","URL","createObjectURL","createElement","download","revokeObjectURL","toSVGFile","visibleRect","svg","svgExport_default","Blob","extension","toProtobuf","protobufExport_default","buffer","updateLinesColor","updateBackground","setBackgroundColor","zazzleMugPrint","recordOpenClick","cityCanvas","getContext","drawImage","from_default","querySelectorAll","label","computedStyle","getComputedStyle","save","dpr","devicePixelRatio","fontSize","font","fontFamily","fillStyle","textAlign","fillText","innerText","restore","drawHtml","querySelector","ga","eventCategory","eventAction","eventLabel","selectortype_template_index_0_src_App","change","!click","src_App","App_normalizeComponent","NoWebGL","src","alt","src_NoWebGL","NoWebGL_normalizeComponent","Vue","productionTip","isWebGLEnabled","template","CanvasPrototype","HTMLCanvasElement","hasBlobConstructor","Boolean","hasArrayBufferViewSupport","size","BlobBuilder","WebKitBlobBuilder","MozBlobBuilder","MSBlobBuilder","dataURIPattern","dataURLtoBlob","atob","ArrayBuffer","dataURI","matches","mediaType","isBase64","dataString","byteString","intArray","bb","match","slice","decodeURIComponent","charCodeAt","getBlob","mozGetAsFile","quality","self","define","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_typeof___default","svgDoc","prev","hasLine","points","pt","point","isOutside","prefix","shouldAddPrefix","join"],"mappings":"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","file":"static/js/app.e6e1a2940cb866eddc00.js","sourcesContent":["var Pbf = require('pbf');\nvar place = require('../proto/place.js').place;\n\nmodule.exports = function protoBufExport(grid) {\n  let nodes = [];\n  let ways = [];\n  let date = (new Date()).toISOString();\n\n  grid.forEachElement(x => {\n    let elementType = 0;\n    if (x.type === 'node') {\n      nodes.push(x)\n    } else if (x.type === 'way') {\n      ways.push(x)\n    }\n  });\n\n  let pbf = new Pbf()\n  place.write({\n    version: 1,\n    id: grid.id,\n    date, \n    name: grid.name,\n    nodes, ways\n  }, pbf);\n  return pbf.finish();\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/protobufExport.js","'use strict'; // code generated by pbf v3.2.1\n\n// place ========================================\n\nvar place = exports.place = {};\n\nplace.read = function (pbf, end) {\n    return pbf.readFields(place._readField, {version: 0, name: \"\", date: \"\", id: \"\", nodes: [], ways: []}, end);\n};\nplace._readField = function (tag, obj, pbf) {\n    if (tag === 1) obj.version = pbf.readVarint();\n    else if (tag === 2) obj.name = pbf.readString();\n    else if (tag === 3) obj.date = pbf.readString();\n    else if (tag === 4) obj.id = pbf.readString();\n    else if (tag === 5) obj.nodes.push(place.node.read(pbf, pbf.readVarint() + pbf.pos));\n    else if (tag === 6) obj.ways.push(place.way.read(pbf, pbf.readVarint() + pbf.pos));\n};\nplace.write = function (obj, pbf) {\n    if (obj.version) pbf.writeVarintField(1, obj.version);\n    if (obj.name) pbf.writeStringField(2, obj.name);\n    if (obj.date) pbf.writeStringField(3, obj.date);\n    if (obj.id) pbf.writeStringField(4, obj.id);\n    if (obj.nodes) for (var i = 0; i < obj.nodes.length; i++) pbf.writeMessage(5, place.node.write, obj.nodes[i]);\n    if (obj.ways) for (i = 0; i < obj.ways.length; i++) pbf.writeMessage(6, place.way.write, obj.ways[i]);\n};\n\n// place.node ========================================\n\nplace.node = {};\n\nplace.node.read = function (pbf, end) {\n    return pbf.readFields(place.node._readField, {id: 0, lat: 0, lon: 0}, end);\n};\nplace.node._readField = function (tag, obj, pbf) {\n    if (tag === 1) obj.id = pbf.readVarint();\n    else if (tag === 2) obj.lat = pbf.readFloat();\n    else if (tag === 3) obj.lon = pbf.readFloat();\n};\nplace.node.write = function (obj, pbf) {\n    if (obj.id) pbf.writeVarintField(1, obj.id);\n    if (obj.lat) pbf.writeFloatField(2, obj.lat);\n    if (obj.lon) pbf.writeFloatField(3, obj.lon);\n};\n\n// place.way ========================================\n\nplace.way = {};\n\nplace.way.read = function (pbf, end) {\n    return pbf.readFields(place.way._readField, {nodes: []}, end);\n};\nplace.way._readField = function (tag, obj, pbf) {\n    if (tag === 1) pbf.readPackedVarint(obj.nodes);\n};\nplace.way.write = function (obj, pbf) {\n    if (obj.nodes) pbf.writePackedVarint(1, obj.nodes);\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/proto/place.js","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('svg',{staticClass:\"loader\",attrs:{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 32 32\",\"width\":\"12\",\"height\":\"12\",\"fill\":\"black\"}},[_c('path',{attrs:{\"opacity\":\".25\",\"d\":\"M16 0 A16 16 0 0 0 16 32 A16 16 0 0 0 16 0 M16 4 A12 12 0 0 1 16 28 A12 12 0 0 1 16 4\"}}),_vm._v(\" \"),_c('path',{attrs:{\"d\":\"M16 0 A16 16 0 0 1 32 16 L28 16 A12 12 0 0 0 16 4z\"}},[_c('animateTransform',{attrs:{\"attributeName\":\"transform\",\"type\":\"rotate\",\"from\":\"0 16 16\",\"to\":\"360 16 16\",\"dur\":\"0.8s\",\"repeatCount\":\"indefinite\"}})],1)])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-5e3ceff5\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/LoadingIcon.vue\n// module id = null\n// module chunks = ","var normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nvar __vue_script__ = null\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-5e3ceff5\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./LoadingIcon.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = null\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/LoadingIcon.vue\n// module id = null\n// module chunks = ","export default function request(url, options) {\n  if (!options) options = {};\n  let req;\n  let progress = options.progress || {};\n  let isCancelled = false;\n  if (progress.on) {\n    progress.onCancel(cancelDownload);\n  }\n\n  return new Promise(download);\n\n  function cancelDownload() {\n    isCancelled = true;\n    if (req) {\n      req.abort();\n    }\n  }\n\n  function download(resolve, reject) {\n    req = new XMLHttpRequest();\n\n    if (typeof progress.notify === 'function') {\n      req.addEventListener('progress', updateProgress, false);\n    }\n\n    req.addEventListener('load', transferComplete, false);\n    req.addEventListener('error', transferFailed, false);\n    req.addEventListener('abort', transferCanceled, false);\n\n    req.open(options.method || 'GET', url);\n    if (options.responseType) {\n      req.responseType = options.responseType;\n    }\n\n    if (options.headers) {\n      Object.keys(options.headers).forEach(key => {\n        req.setRequestHeader(key, options.headers[key]);\n      });\n    }\n\n    if (options.method === 'POST') {\n      req.send(options.body);\n    } else {\n      req.send(null);\n    }\n\n    function updateProgress(e) {\n      if (e.lengthComputable) {\n        progress.notify({\n          loaded: e.loaded,\n          total: e.total,\n          percent: e.loaded / e.total,\n          lengthComputable: true\n        });\n      } else {\n        progress.notify({\n          loaded: e.loaded,\n          lengthComputable: false\n        });\n      }\n    }\n\n    function transferComplete() {\n      progress.offCancel(cancelDownload);\n\n      if (progress.isCancelled) return;\n\n      if (req.status !== 200) {\n        reject({\n          statusError: req.status,\n          message: `Unexpected status code ${req.status} when calling ${url}`\n        });\n        return;\n      }\n      var response = req.response;\n\n      if (options.responseType === 'json' && typeof response === 'string') {\n        // IE\n        response = JSON.parse(response);\n      }\n\n      setTimeout(() => resolve(response), 0);\n    }\n\n    function transferFailed() {\n      reject(`Failed to download ${url}`);\n    }\n\n    function transferCanceled() {\n      reject({\n        cancelled: true,\n        message: `Cancelled download of ${url}`\n      });\n    }\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/request.js","import request from './request';\n\nlet backends = [\n  'https://overpass.kumi.systems/api/interpreter',\n  'https://overpass-api.de/api/interpreter',\n  'https://overpass.openstreetmap.ru/cgi/interpreter'\n]\n\nexport default function postData(data, progress) {\n  const postData = {\n    method: 'POST',\n    responseType: 'json',\n    progress,\n    headers: {\n      'Content-type': 'application/x-www-form-urlencoded; charset=UTF-8'\n    },\n    body: 'data=' + encodeURIComponent(data),\n  };\n\n  let serverIndex = 0;\n\n  return fetchFrom(backends[serverIndex]);\n\n  function fetchFrom(overpassUrl) {\n    return request(overpassUrl, postData, 'POST')\n      .catch(handleError);\n  }\n\n  function handleError(err) {\n    if (err.cancelled) throw err;\n\n    if (serverIndex >= backends.length - 1) {\n      // we can't do much anymore\n      throw err;\n    } \n\n    if (err.statusError) {\n      progress.notify({\n        loaded: -1\n      });\n    }\n\n    serverIndex += 1;\n    return fetchFrom(backends[serverIndex])\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/postData.js","import createQueryState from 'query-state';\n\nconst queryState = createQueryState({}, {useSearch: true});\n\nexport default {\n  drawLabels: true,\n  backgroundColor: {\n    r: 0xF7, g: 0xF2, b: 0xE8, a: 1\n  },\n  lineColor: {\n    r: 22, g: 22, b: 22, a: 1.0\n  },\n  labelColor: {\n    r: 22, g: 22, b: 22, a: 1.0\n  },\n  get() {\n    return queryState.get.apply(queryState, arguments);\n  },\n  set() {\n    return queryState.set.apply(queryState, arguments);\n  },\n  unset() {\n    return queryState.unset.apply(queryState, arguments);\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/appState.js","export default class BBox {\n  constructor() {\n    this.minX = Infinity;\n    this.minY = Infinity;\n    this.maxX = -Infinity;\n    this.maxY = -Infinity;\n  }\n\n  growBy(offset) {\n    this.minX -= offset;\n    this.minY -= offset;\n    this.maxX += offset;\n    this.maxY += offset;\n  }\n\n  get left() {\n    return this.minX;\n  }\n\n  get top() {\n    return this.minY;\n  }\n\n  get right() {\n    return this.maxX;\n  }\n\n  get bottom() {\n    return this.maxY;\n  }\n\n  get width() {\n    return this.maxX - this.minX;\n  }\n\n  get height() {\n    return this.maxY - this.minY;\n  }\n\n  get cx() {\n    return (this.minX + this.maxX)/2;\n  }\n\n  get cy() {\n    return (this.minY + this.maxY)/2;\n  }\n\n  addPoint(xIn, yIn) {\n    if (xIn === undefined) throw new Error('Point is not defined');\n    let x = xIn;\n    let y = yIn;\n    if (y === undefined) {\n      // xIn is a point object\n      x = xIn.x;\n      y = xIn.y;\n    }\n\n    if (x < this.minX) this.minX = x;\n    if (x > this.maxX) this.maxX = x;\n    if (y < this.minY) this.minY = y;\n    if (y > this.maxY) this.maxY = y;\n  }\n\n  addRect(rect) {\n    if (!rect) throw new Error('rect is not defined');\n    this.addPoint(rect.left, rect.top);\n    this.addPoint(rect.right, rect.top);\n    this.addPoint(rect.left, rect.bottom);\n    this.addPoint(rect.right, rect.bottom);\n  }\n\n  merge(otherBBox) {\n    if (otherBBox.minX < this.minX) this.minX = otherBBox.minX;\n    if (otherBBox.minY < this.minY) this.minY = otherBBox.minY;\n    if (otherBBox.maxX > this.maxX) this.maxX = otherBBox.maxX;\n    if (otherBBox.maxY > this.maxY) this.maxY = otherBBox.maxY;\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/BoundingBox.js","import BoundingBox from './BoundingBox';\nimport {geoMercator} from 'd3-geo';\n\n/**\n * All roads in the area\n */\nexport default class Grid {\n  constructor() {\n    this.elements = [];\n    this.bounds = new BoundingBox();\n    this.nodes = new Map();\n    this.wayPointCount = 0;\n    this.id = 0;\n    this.name = '';\n    this.projector = geoMercator();\n  }\n\n  setName(name) {\n    this.name = name;\n  }\n\n  setId(id) {\n    this.id = id;\n  }\n\n  static fromPBF(pbf) {\n    if (pbf.version !== 1) throw new Error('Unknown version ' + pbf.version);\n    let elementsOfOSMResponse = [];\n    pbf.nodes.forEach(node => {\n      node.type = 'node';\n      elementsOfOSMResponse.push(node)\n    });\n    pbf.ways.forEach(way => {\n      way.type = 'way';\n      elementsOfOSMResponse.push(way);\n    });\n\n    const grid = Grid.fromOSMResponse(elementsOfOSMResponse);\n    grid.setName(pbf.name);\n    grid.setId(pbf.id);\n    return grid;\n  }\n\n  static fromOSMResponse(elementsOfOSMResponse) {\n    let gridInstance = new Grid();\n\n    let nodes = gridInstance.nodes;\n    let bounds = gridInstance.bounds;\n    let wayPointCount = 0;\n\n    // TODO: async?\n    elementsOfOSMResponse.forEach(element => {\n      if (element.type === 'node') {\n        nodes.set(element.id, element);\n        bounds.addPoint(element.lon, element.lat);\n      } else if (element.type === 'way') {\n        wayPointCount += element.nodes.length;\n      }\n    });\n\n    gridInstance.elements = elementsOfOSMResponse;\n    gridInstance.projector\n      .center([bounds.cx, bounds.cy])\n      .scale(6371393); // Radius of Earth\n\n    gridInstance.wayPointCount = wayPointCount;\n    return gridInstance;\n  }\n\n  getProjectedRect() {\n    let bounds = this.bounds;\n    let project = this.getProjector();\n    let leftTop = project({lon: bounds.left, lat: bounds.bottom});\n    let rightBottom = project({lon: bounds.right, lat: bounds.top});\n    let left = leftTop.x;\n    let top = leftTop.y;\n    let bottom = rightBottom.y\n    let right = rightBottom.x;\n    return {\n      left, top, right, bottom,\n      width: right - left, height: Math.abs(bottom - top)\n    }\n  }\n\n  forEachElement(callback) {\n    this.elements.forEach(callback);\n  }\n\n  forEachWay(callback) {\n    let positions = this.nodes;\n    let project = this.getProjector();\n    this.elements.forEach(element => {\n      if (element.type !== 'way') return;\n\n      let nodeIds = element.nodes;\n      let last = project(positions.get(nodeIds[0]));\n\n      for (let index = 1; index < nodeIds.length; ++index) {\n        let next = project(positions.get(nodeIds[index]));\n\n        callback(last, next);\n\n        last = next;\n      }\n    });\n  }\n\n  getProjector() {\n    let q = [0, 0]; // reuse to avoid GC.\n    let projector = this.projector;\n\n    return project;\n\n    function project({lon, lat}) {\n      q[0] = lon; q[1] = lat;\n\n      let xyPoint = projector(q);\n\n      return {\n        x: xyPoint[0],\n        y: xyPoint[1]\n      };\n    }\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/Grid.js","export default {\n  //areaServer: 'http://localhost:8081/'\n  //areaServer: 'http://localhost:8085/'\n  areaServer: 'https://anvaka.github.io/index-large-cities/data'\n}\n\n\n// WEBPACK FOOTER //\n// ./src/config.js","import eventify from 'ngraph.events';\n\nexport default class Progress {\n  constructor(notify) {\n    eventify(this)\n    this.callback = notify;\n  }\n\n  cancel() {\n    this.isCancelled = true;\n    this.fire('cancel');\n  }\n\n  notify(progress) {\n    if (!this.isCancelled) {\n      this.callback(progress);\n    }\n  }\n\n  onCancel(callback) {\n    this.on('cancel', callback, this);\n  }\n\n  offCancel(callback) {\n    this.off('cancel', callback);\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/Progress.js","<template>\n<div class='find-place' :class='{centered: !suggestionsLoaded }'>\n  <div v-if='!suggestionsLoaded'>\n    <h3 class='site-header'>city roads</h3>\n    <p class='description'>This website renders every single road within a city</p>\n  </div>\n  <form v-on:submit.prevent=\"onSubmit\" class='search-box'>\n      <input class='query-input' v-model='enteredInput' type='text' placeholder='Enter a city name to start' ref='input'>\n      <a type='submit' class='search-submit' href='#' @click.prevent='onSubmit' v-if='enteredInput && !hideInput'>{{mainActionText}}</a>\n  </form>\n  <div v-if='showWarning' class='prompt message note shadow'>\n    Note: Large cities may require 200MB+ of data transfer and may need a powerful device to render.\n  </div>\n  <div class='results' v-if='!loading'>\n    <div v-if='suggestionsLoaded && data.length' class='suggestions shadow'>\n      <div class='prompt message'>\n        <div>Select boundaries below to download all roads within</div>\n        <div class='note'>large cities may require 200MB+ of data transfer and a powerful device</div>\n      </div>\n      <ul>\n        <li v-for='(suggestion, index) in data' :key=\"index\">\n          <a @click.prevent='pickSuggestion(suggestion)' class='suggestion'\n          href='#'>\n          <span>\n          {{suggestion.name}} <small>({{suggestion.type}})</small>\n          </span>\n          </a>\n        </li>\n      </ul>\n    </div>\n    <div v-if='suggestionsLoaded && !data.length && !loading' class='no-results message shadow'>\n      Didn't find matching cities. Try a different query?\n    </div>\n    <div v-if='noRoads' class='no-results message shadow'>\n      Didn't find any roads. Try a different query?\n    </div>\n  </div>\n  <div v-if='error' class='error message shadow'>\n    <div>Something went wrong. The error was:</div>\n    <pre>{{error}}</pre>\n  </div>\n  <div v-if='loading' class='loading message shadow'>\n    <loading-icon></loading-icon>\n    <span>{{loading}}</span>\n    <a href=\"#\" @click.prevent='cancelRequest' class='cancel-request'>cancel</a>\n    <div class='load-padding' v-if='stillLoading > 0'>\n      Still loading...\n    </div>\n    <div class='load-padding' v-if='stillLoading > 1'>\n      Sorry it takes so long!\n    </div>\n  </div>\n</div>\n</template>\n\n<script>\nimport LoadingIcon from './LoadingIcon';\nimport postData from '../lib/postData';\nimport request from '../lib/request';\nimport appState from '../lib/appState';\nimport Grid from '../lib/Grid';\nimport queryState from '../lib/appState';\nimport config from '../config';\nimport Progress from '../lib/Progress'\n\nconst FIND_TEXT = 'Find City Bounds';\n\nexport default {\n  name: 'FindPlace',\n  components: {\n    LoadingIcon\n  },\n  data () {\n    let hasValidArea = this.getCurrentAreaId();\n\n    return {\n      enteredInput: appState.get('q') || '',\n      loading: null,\n      lastCancel: null,\n      suggestionsLoaded: false,\n      stillLoading: 0,\n      error: null,\n      hideInput: false,\n      noRoads: false,\n      clicked: false,\n      showWarning: hasValidArea, \n      mainActionText: hasValidArea ? 'Download Area' : FIND_TEXT,\n      data: []\n    }\n  },\n  watch: {\n    enteredInput() {\n      // As soon as they change it, we need not to download:\n      this.mainActionText = FIND_TEXT;\n      this.showWarning = false;\n      this.hideInput = false;\n      if (appState.get('areaId')) {\n        appState.unset('areaId');\n      }\n    }\n  },\n  mounted() {\n    this.$refs.input.focus();\n  },\n  beforeDestroy() {\n    if (this.lastCancel) this.lastCancel();\n    clearInterval(this.notifyStillLoading);\n  },\n  methods: {\n    getCurrentAreaId() {\n      let areaId = appState.get('areaId');\n      if (!Number.isFinite(Number.parseInt(areaId, 10))) {\n        areaId = null;\n      }\n      return areaId;\n    },\n    onSubmit() {\n      queryState.set('q', this.enteredInput);\n      this.cancelRequest()\n      this.data = [];\n      this.noRoads = false;\n      this.error = false;\n      this.showWarning = false;\n\n      let areaId = this.getCurrentAreaId();\n      if (areaId) {\n        this.pickSuggestion({\n          name: this.enteredInput,\n          areaId\n        });\n        return;\n      }\n\n      const query = encodeURIComponent(this.enteredInput);\n      this.loading = 'Searching cities that match your query...'\n      fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${query}`)\n        .then(x => x.json())\n        .then(x => x.filter(row => row.osm_type === 'relation').map(row => ({\n          name: row.display_name,\n          type: row.type,\n          areaId: row.osm_id + 36e8\n        })))\n        .then(data => {\n          this.loading = null;\n          this.suggestionsLoaded = true;\n          this.data = data;\n          this.hideInput = data && data.length;\n        });\n    },\n\n    updateProgress(status) {\n      this.stillLoading = 0;\n      clearInterval(this.notifyStillLoading);\n      if (status.loaded < 0) {\n        this.loading = 'Trying a different server'\n        this.restartLoadingMonitor();\n        return;\n      }\n      if (status.percent !== undefined) {\n        this.loading = 'Loaded ' + Math.round(100 * status.percent) + '% (' + formatNumber(status.loaded) + ' bytes)...';\n      } else {\n        this.loading = 'Loaded ' + formatNumber(status.loaded) + ' bytes...';\n      }\n    },\n\n    pickSuggestion(suggestion) {\n      this.checkCache(suggestion)\n        .catch(error => {\n          if (error.cancelled) return; // no need to do anything. They've cancelled\n\n          // No Cache - fallback\n          return this.useOSM(suggestion);\n        });\n\n      this.error = false;\n    },\n\n    restartLoadingMonitor() {\n      clearInterval(this.notifyStillLoading);\n      this.stillLoading = 0;\n      this.notifyStillLoading = setInterval(() => {\n        this.stillLoading++;\n      }, 10000);\n    },\n\n    checkCache(suggestion) {\n      this.loading = 'Checking cache...'\n      let areaId = suggestion.areaId;\n\n      return request(config.areaServer + '/' + areaId + '.pbf', {\n        progress: this.generateNewProgressToken(),\n        responseType: 'arraybuffer'\n      }).then(arrayBuffer => {\n        var byteArray = new Uint8Array(arrayBuffer);\n        return byteArray;\n      }).then(byteArray => {\n        var Pbf = require('pbf');\n        var place = require('../proto/place.js').place;\n        var pbf = new Pbf(byteArray);\n        var obj = place.read(pbf);\n        let grid = Grid.fromPBF(obj)\n        this.$emit('loaded', grid);\n      });\n    },\n\n    useOSM(suggestion) {\n      this.loading = 'Connecting to OpenStreetMaps...'\n      \n      // it may take a while to load data. \n      this.restartLoadingMonitor();\n\n      postData(getQuery(suggestion.areaId), this.generateNewProgressToken())\n        .then(osmResponse => {\n          this.loading = null;\n          if (osmResponse.elements.length === 0) {\n            this.noRoads = true;\n            return;\n          }\n\n          let grid = Grid.fromOSMResponse(osmResponse.elements)\n          grid.setName(suggestion.name);\n          grid.setId(suggestion.areaId);\n          this.$emit('loaded', grid);\n        })\n        .catch(err => {\n          if (err.cancelled) {\n            this.loading = null;\n            return;\n          }\n          console.error(err);\n          this.error = err;\n          this.loading = null;\n          this.data = [];\n        })\n        .finally(() => {\n          clearInterval(this.notifyStillLoading);\n          this.stillLoading = 0;\n        });\n    },\n\n    cancelRequest() {\n      if (this.progressToken) {\n        this.progressToken.cancel();\n        this.progressToken = null;\n        this.loading = false;\n      }\n    },\n\n    generateNewProgressToken() {\n      if (this.progressToken) {\n        this.progressToken.cancel();\n        this.progressToken = null;\n      }\n\n      this.progressToken = new Progress(this.updateProgress);\n      return this.progressToken;\n    }\n  }\n}\n\nfunction getQuery(areaId) {\n    return `[timeout:9000][maxsize:2000000000][out:json];\narea(${areaId});\n(._; )->.area;\n(\nway[\"highway\"](area.area);\nnode(w);\n);\nout skel;`;\n}\n\nfunction formatNumber(x) {\n  if (!Number.isFinite(x)) return 'N/A';\n  return x.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\n}\n</script>\n\n<style lang=\"stylus\">\n@import('../vars.styl');\n.find-place  {\n  width: desktop-controls-width;\n}\n\nh3.site-header {\n  margin: 0;\n  font-weight: normal;\n  font-size: 32px;\n  text-align: center;\n}\n\ninput {\n  border: none;\n  flex: 1;\n  font-family: 'Avenir', Helvetica, Arial, sans-serif;\n  padding: 0;\n  color: #434343;\n  height: 100%;\n  font-size: 16px;\n  &:focus {\n    outline: none;\n  }\n}\n\n.search-box {\n  position: relative;\n  background-color: emphasis-background;\n  padding: 0 8px;\n  padding: 0 0 0 8px;\n\n  box-shadow: 0 2px 4px rgba(0,0,0,0.2), 0 -1px 0px rgba(0,0,0,0.02);\n  height: 48px;\n  display: flex;\n  font-size: 16px;\n  cursor: text;\n  a {\n    cursor: pointer;\n  }\n  span {\n    display: flex;\n    align-items: center;\n    flex-shrink: 0;\n  }\n}\n\n.prompt {\n  padding: 4px;\n  text-align: center;\n  font-size: 12px;\n}\n\n.search-submit {\n  padding: 0 8px;\n  align-items: center;\n  text-decoration: none;\n  display: flex;\n  flex-shrink: 0;\n  justify-content: center;\n  outline: none;\n  color: highlight-color\n  &:hover {\n    color: emphasis-background;\n    background: highlight-color;\n  }\n}\n\n.suggestion {\n  display: block\n  min-height: 64px\n  align-items: center;\n  border-bottom: 1px solid border-color\n  display: flex\n  padding: 0 10px;\n  text-decoration: none\n  color: highlight-color\n}\n\n.suggestions {\n  position: relative;\n  background: white\n  .note {\n    font-size: 10px;\n    font-style: italic;\n  }\n\n  ul {\n    list-style-type: none\n    margin: 0\n    padding: 0\n  }\n}\n\n.message,\n.loading {\n  padding: 4px 8px;\n  position: relative;\n}\n.shadow {\n  box-shadow: 0 2px 4px rgba(0,0,0,0.2)\n}\n\n.error {\n  overflow-x: auto;\n}\n\n.find-place {\n  position: absolute;\n  display: flex;\n  flex-direction: column;\n  top: 8px;\n  left: 50%;\n\n  transform: translateX(-50%) translateY(0);\n  transition-timing-function: ease-out;\n  transition-property: top left transform;\n  transition-duration: 0.3s;\n}\n\n.find-place.centered {\n  top: 50%;\n  left: 50%;\n  transform: translateX(-50%) translateY(-143px);\n}\n.load-padding {\n  padding-left: 16px;\n}\n.description {\n  padding: 8px;\n  margin: 0;\n  text-align: center;\n}\n\n.cancel-request {\n  position: absolute;\n  right: 4px;\n  top: 4px;\n  font-size: 12px;\n}\n\n@media (max-width: small-screen) {\n  .find-place {\n    width: 100%;\n  }\n  .find-place.centered {\n    top: 8px;\n    left: 0;\n    transform: none;\n  }\n  .message {\n    font-size: 12px;\n  }\n  .prompt {\n    font-size: 12px;\n    .note {\n      font-size: 9px;\n    }\n  }\n}\n\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/FindPlace.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"find-place\",class:{centered: !_vm.suggestionsLoaded }},[(!_vm.suggestionsLoaded)?_c('div',[_c('h3',{staticClass:\"site-header\"},[_vm._v(\"city roads\")]),_vm._v(\" \"),_c('p',{staticClass:\"description\"},[_vm._v(\"This website renders every single road within a city\")])]):_vm._e(),_vm._v(\" \"),_c('form',{staticClass:\"search-box\",on:{\"submit\":function($event){$event.preventDefault();return _vm.onSubmit($event)}}},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.enteredInput),expression:\"enteredInput\"}],ref:\"input\",staticClass:\"query-input\",attrs:{\"type\":\"text\",\"placeholder\":\"Enter a city name to start\"},domProps:{\"value\":(_vm.enteredInput)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.enteredInput=$event.target.value}}}),_vm._v(\" \"),(_vm.enteredInput && !_vm.hideInput)?_c('a',{staticClass:\"search-submit\",attrs:{\"type\":\"submit\",\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.onSubmit($event)}}},[_vm._v(_vm._s(_vm.mainActionText))]):_vm._e()]),_vm._v(\" \"),(_vm.showWarning)?_c('div',{staticClass:\"prompt message note shadow\"},[_vm._v(\"\\n    Note: Large cities may require 200MB+ of data transfer and may need a powerful device to render.\\n  \")]):_vm._e(),_vm._v(\" \"),(!_vm.loading)?_c('div',{staticClass:\"results\"},[(_vm.suggestionsLoaded && _vm.data.length)?_c('div',{staticClass:\"suggestions shadow\"},[_vm._m(0),_vm._v(\" \"),_c('ul',_vm._l((_vm.data),function(suggestion,index){return _c('li',{key:index},[_c('a',{staticClass:\"suggestion\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.pickSuggestion(suggestion)}}},[_c('span',[_vm._v(\"\\n          \"+_vm._s(suggestion.name)+\" \"),_c('small',[_vm._v(\"(\"+_vm._s(suggestion.type)+\")\")])])])])}),0)]):_vm._e(),_vm._v(\" \"),(_vm.suggestionsLoaded && !_vm.data.length && !_vm.loading)?_c('div',{staticClass:\"no-results message shadow\"},[_vm._v(\"\\n      Didn't find matching cities. Try a different query?\\n    \")]):_vm._e(),_vm._v(\" \"),(_vm.noRoads)?_c('div',{staticClass:\"no-results message shadow\"},[_vm._v(\"\\n      Didn't find any roads. Try a different query?\\n    \")]):_vm._e()]):_vm._e(),_vm._v(\" \"),(_vm.error)?_c('div',{staticClass:\"error message shadow\"},[_c('div',[_vm._v(\"Something went wrong. The error was:\")]),_vm._v(\" \"),_c('pre',[_vm._v(_vm._s(_vm.error))])]):_vm._e(),_vm._v(\" \"),(_vm.loading)?_c('div',{staticClass:\"loading message shadow\"},[_c('loading-icon'),_vm._v(\" \"),_c('span',[_vm._v(_vm._s(_vm.loading))]),_vm._v(\" \"),_c('a',{staticClass:\"cancel-request\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.cancelRequest($event)}}},[_vm._v(\"cancel\")]),_vm._v(\" \"),(_vm.stillLoading > 0)?_c('div',{staticClass:\"load-padding\"},[_vm._v(\"\\n      Still loading...\\n    \")]):_vm._e(),_vm._v(\" \"),(_vm.stillLoading > 1)?_c('div',{staticClass:\"load-padding\"},[_vm._v(\"\\n      Sorry it takes so long!\\n    \")]):_vm._e()],1):_vm._e()])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"prompt message\"},[_c('div',[_vm._v(\"Select boundaries below to download all roads within\")]),_vm._v(\" \"),_c('div',{staticClass:\"note\"},[_vm._v(\"large cities may require 200MB+ of data transfer and a powerful device\")])])}]\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-7c411e0e\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/FindPlace.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-7c411e0e\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!stylus-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./FindPlace.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./FindPlace.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./FindPlace.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-7c411e0e\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./FindPlace.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/FindPlace.vue\n// module id = null\n// module chunks = ","// Based on https://github.com/ElemeFE/element/blob/dev/src/utils/clickoutside.js\n// The MIT License (MIT), Copyright (c) 2016 ElemeFE\nconst nodeList = [];\nconst ctx = '@@clickoutsideContext';\n\nlet startClick;\nlet seed = 0;\n\ndocument.addEventListener('mousedown', e => (startClick = e), true);\ndocument.addEventListener('mouseup', e => {\n  nodeList.forEach(node => node[ctx].documentHandler(e, startClick));\n}, true);\n\n// Also hide when tapped outside.\ndocument.addEventListener('touchstart', e => {\n  startClick = e;\n}, true);\ndocument.addEventListener('touchend', e => {\n  nodeList.forEach(node => node[ctx].documentHandler(e, startClick));\n}, true);\n\nfunction createDocumentHandler(el, binding, vnode) {\n  return function(mouseup = {}, mousedown = {}) {\n    if (!vnode || !vnode.context ||\n      !mouseup.target || !mousedown.target ||\n      el.contains(mouseup.target) ||\n      el.contains(mousedown.target) ||\n      el === mouseup.target ||\n      (vnode.context.popperElm &&\n      (vnode.context.popperElm.contains(mouseup.target) ||\n      vnode.context.popperElm.contains(mousedown.target)))) return;\n\n    const methodName = el[ctx].methodName;\n    if (binding.expression && methodName && vnode.context[methodName]) {\n      vnode.context[methodName]();\n    } else {\n      el[ctx].bindingFn && el[ctx].bindingFn();\n    }\n  };\n}\n\nexport default {\n  bind(el, binding, vnode) {\n    nodeList.push(el);\n    const id = seed++;\n    el[ctx] = {\n      id,\n      documentHandler: createDocumentHandler(el, binding, vnode),\n      methodName: binding.expression,\n      bindingFn: binding.value\n    };\n  },\n\n  update(el, binding, vnode) {\n    el[ctx].documentHandler = createDocumentHandler(el, binding, vnode);\n    el[ctx].methodName = binding.expression;\n    el[ctx].bindingFn = binding.value;\n  },\n\n  unbind(el) {\n    let len = nodeList.length;\n\n    for (let i = 0; i < len; i++) {\n      if (nodeList[i][ctx].id === el[ctx].id) {\n        nodeList.splice(i, 1);\n        break;\n      }\n    }\n    delete el[ctx];\n  }\n};\n\n\n// WEBPACK FOOTER //\n// ./src/components/clickOutside.js","<template>\n  <div v-click-outside='looseFocus'>\n    <div class='editable-label'>\n      <span :class='{printable}'>{{value}}</span>\n      <input\n        v-bind:value=\"value\"\n        v-on:input=\"$emit('input', $event.target.value)\"\n        ref='input'\n      >\n    </div>\n  </div>\n</template>\n<script>\nimport ClickOutside from './clickOutside.js'\n\nexport default {\n  name: 'EditableLabel',\n  props: ['value', 'printable'],\n  directives: { ClickOutside },\n  methods: {\n    looseFocus() {\n      this.$refs.input.blur();\n    }\n  }\n}\n</script>\n<style lang=\"stylus\">\n@import('../vars.styl');\n\n.editable-label {\n  position: relative;\n\n  span {\n    position: relative;\n    top: 0;\n    left: 0;\n    display: flex;\n    align-items : center;\n    font-family: labels-font;\n    white-space: pre;\n    padding: 8px;\n    border: 1px solid transparent;\n  }\n\n  input {\n    caret-color: primary-text;\n    color: transparent;\n    font-family: labels-font;\n    background: transparent;\n    display: flex;\n    align-items: center;\n    position: absolute;\n    overflow: hidden;\n    top: 0;\n    left: 0;\n    width: 100%;\n    padding: 8px;\n    border: 1px solid transparent;\n    &:focus {\n      border: 1px dashed highlight-color;\n    }\n\n  }\n}\n  \n</style>\n\n\n// WEBPACK FOOTER //\n// src/components/EditableLabel.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{directives:[{name:\"click-outside\",rawName:\"v-click-outside\",value:(_vm.looseFocus),expression:\"looseFocus\"}]},[_c('div',{staticClass:\"editable-label\"},[_c('span',{class:{printable: _vm.printable}},[_vm._v(_vm._s(_vm.value))]),_vm._v(\" \"),_c('input',{ref:\"input\",domProps:{\"value\":_vm.value},on:{\"input\":function($event){return _vm.$emit('input', $event.target.value)}}})])])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-1e35101e\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/EditableLabel.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-1e35101e\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!stylus-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./EditableLabel.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./EditableLabel.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./EditableLabel.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-1e35101e\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./EditableLabel.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/EditableLabel.vue\n// module id = null\n// module chunks = ","\n<template>\n<div class='vue-colorpicker' @click='showPicker = true' v-click-outside='hide' >\n  <span class='vue-colorpicker-btn' :style='btnStyle' ref='triggerButton'></span>\n  <div class='vue-colorpicker-panel' v-show='showPicker' :style=\"{left: panelLeft, top: panelTop}\">\n    <component :is='pickerType' v-model='colors' @input='changeColor'></component>\n  </div>\n</div>\n</template>\n\n<script>\nimport tinycolor from 'tinycolor2'\nimport { Sketch } from 'vue-color'\nimport ClickOutside from './clickOutside.js'\n\nexport default {\n  name: 'vue-colorpicker',\n  components: {\n    'sketch-picker': Sketch,\n  },\n  directives: { ClickOutside },\n  props: {\n    value: {\n      type: Object,\n    },\n  },\n  data () {\n    return {\n      showPicker: false,\n      colors: {\n        hex: '#FFFFFF',\n        a: 1\n      },\n      colorValue: '#FFFFFF',\n      panelLeft: '0px',\n      panelTop: '0px'\n    }\n  },\n  computed: {\n    pickerType () {\n      return 'sketch-picker';\n    },\n    isTransparent () {\n      return this.colors.a === 0;\n    },\n    btnStyle () {\n      if (this.isTransparent) {\n        return {\n          background: '#eee',\n          backgroundImage: 'linear-gradient(45deg, rgba(0,0,0,.25) 25%, transparent 0, transparent 75%,rgba(0,0,0,.25)0), linear-gradient(45deg, rgba(0,0,0,.25)25%,transparent 0, transparent 75%,rgba(0,0,0,.25)0)',\n          backgroundPosition: '0 0, 11px 11px',\n          backgroundSize: '22px 22px'\n        }\n      }\n      let {r, g, b, a} = this.colorValue;\n      return {\n        background: `rgba(${r}, ${g}, ${b}, ${a})`\n      }\n    },\n  },\n  watch: {\n    value (val, oldVal) {\n      if (val !== oldVal) {\n        this.updateColorObject(val);\n      }\n    },\n    showPicker(newVal) {\n      if (!newVal) return;\n\n      const PICKER_WIDTH = 220;\n      const PANEL_HEIGHT = 320;\n      let triggerRect = this.$refs.triggerButton.getBoundingClientRect();\n      let desiredLeft = triggerRect.x;\n      let desiredTop = triggerRect.bottom;\n      if (triggerRect.y + PANEL_HEIGHT > window.innerHeight) {\n        desiredTop = Math.max(0, window.innerHeight - PANEL_HEIGHT);\n        desiredLeft += 36; // so that the selector button is still visible;\n      }\n      if (desiredLeft + PICKER_WIDTH > window.innerWidth) {\n        desiredLeft = Math.max(0, window.innerWidth - PICKER_WIDTH);\n      } \n      this.panelLeft = desiredLeft + 'px';\n      this.panelTop = desiredTop + 'px';\n    }\n  },\n\n  methods: {\n    hide () {\n      this.showPicker = false;\n    },\n    changeColor (data) {\n      this.colorValue = data.rgba;\n      this.$emit('input', this.colorValue)\n      this.$emit('change', this.colorValue)\n    },\n    updateColorObject (color) {\n      if (!color) return\n      const colorObj = tinycolor(`rgba(${color.r}, ${color.g}, ${color.b}, ${color.a})` || 'transparent');\n      if (!color || color === 'transparent') {\n        this.colors = {\n          hex: '#FFFFFF',\n          hsl: { h: 0, s: 0, l: 1, a: 0 },\n          hsv: { h: 0, s: 0, v: 1, a: 0 },\n          rgba: { r: 255, g: 255, b: 255, a: 0 },\n          a: 0\n        };\n      } else {\n        this.colors = {\n          hex: colorObj.toHexString(),\n          hsl: colorObj.toHsl(),\n          hsv: colorObj.toHsv(),\n          rgba: colorObj.toRgb(),\n          a: colorObj.getAlpha()\n        };\n      }\n      this.colorValue = this.colors.rgba;\n    }\n  },\n  mounted () {\n    this.updateColorObject(this.value)\n  }\n}\n</script>\n\n<style lang=\"stylus\" scoped>\n.vue-colorpicker {\n  display: inline-block;\n  box-sizing: border-box;\n  font-size: 0;\n  cursor: pointer;\n  &-btn {\n    display: inline-block;\n    width: 30px;\n    height: 22px;\n    border: 1px solid #666;\n    background: #FFFFFF;\n  }\n\n  .vue-colorpicker-panel {\n    position: absolute;\n    z-index: 1;\n  }\n}\n</style>\n\n\n// WEBPACK FOOTER //\n// src/components/ColorPicker.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{directives:[{name:\"click-outside\",rawName:\"v-click-outside\",value:(_vm.hide),expression:\"hide\"}],staticClass:\"vue-colorpicker\",on:{\"click\":function($event){_vm.showPicker = true}}},[_c('span',{ref:\"triggerButton\",staticClass:\"vue-colorpicker-btn\",style:(_vm.btnStyle)}),_vm._v(\" \"),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.showPicker),expression:\"showPicker\"}],staticClass:\"vue-colorpicker-panel\",style:({left: _vm.panelLeft, top: _vm.panelTop})},[_c(_vm.pickerType,{tag:\"component\",on:{\"input\":_vm.changeColor},model:{value:(_vm.colors),callback:function ($$v) {_vm.colors=$$v},expression:\"colors\"}})],1)])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-60c70430\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/ColorPicker.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-60c70430\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!stylus-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./ColorPicker.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./ColorPicker.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./ColorPicker.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-60c70430\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./ColorPicker.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-60c70430\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/ColorPicker.vue\n// module id = null\n// module chunks = ","\n/**\n * This file is responsible for rendering of the grid. It uses my silly 2d webgl\n * renderer which is not very well documented, neither popular, yet it is very\n * fast.\n */\nconst wgl = require('w-gl');\n\nexport default function createScene(grid, canvas) {\n  let scene = wgl.scene(canvas);\n  scene.setClearColor(0xf7/0xff, 0xf2/0xff, 0xe8/0xff, 1.0);\n\n  let viewBox = getInitialViewBox();\n  scene.setViewBox(viewBox);\n\n  let slowDownZoom = false;\n  let lines = createLinesCollection();\n  scene.appendChild(lines);\n  listenToEvents();\n\n  return {\n    render() {\n      scene.renderFrame(true);\n    },\n    getProjectedVisibleRect,\n    dispose() {\n      scene.clear();\n      scene.dispose();\n      unsubscribeFromEvents();\n    },\n    setLineColor(color) {\n      lines.color = {r: color.r/0xff, g: color.g/0xff, b: color.b/0xff, a: color.a};\n      scene.renderFrame();\n    },\n    setBackground(color) {\n      scene.setClearColor(color.r/0xff, color.g/0xff, color.b/0xff, color.a);\n      scene.renderFrame();\n    }\n  };\n\n  function getProjectedVisibleRect() {\n    var leftTop = scene.getSceneCoordinate(0, 0);\n    var bottomRight = scene.getSceneCoordinate(window.innerWidth, window.innerHeight);\n    let rect = {\n      left: leftTop.x,\n      top: leftTop.y,\n      right: bottomRight.x,\n      bottom: bottomRight.y\n    };\n    rect.width = rect.right - rect.left;\n    rect.height = rect.bottom - rect.top;\n\n    return rect;\n  }\n\n  function getInitialViewBox() {\n    let {width, height} = grid.getProjectedRect();\n    let initialSceneSize = Math.max(width, height) / 4;\n    return {\n      left:  -initialSceneSize,\n      top:   -initialSceneSize,\n      right:  initialSceneSize,\n      bottom: initialSceneSize,\n    }\n  }\n\n  function createLinesCollection() {\n    let lineWidth = 1;\n    let lines;\n    if (lineWidth < 2) {\n      // Wire collection cannot have width, this reduces amount of memory it needs\n      // though doesn't let us render nice thick lines.\n      lines = new wgl.WireCollection(grid.wayPointCount);\n      grid.forEachWay(function(from, to) {\n        lines.add({from, to});\n      });\n    }  else {\n      // This is not exposed anywhere, gives thick lines, though the caps are\n      // jagged.\n      lines = new wgl.LineCollection(grid.wayPointCount);\n      grid.forEachWay(function(from, to) {\n        let ui = lines.add({from, to});\n        ui.setWidth(lineWidth);\n        ui.update(from, to);\n      });\n    }\n    //lines.color = {r: 0.8, g: 0.8, b: 0.8, a: 0.7}\n    lines.color = {r: 0.1, g: 0.1, b: 0.1, a: 0.8}\n\n    return lines;\n  }\n\n  function listenToEvents() {\n    document.addEventListener('keydown', onKeyDown, true);\n    document.addEventListener('keyup', onKeyUp, true);\n  }\n\n  function unsubscribeFromEvents() {\n    document.removeEventListener('keydown', onKeyDown, true);\n    document.removeEventListener('keyup', onKeyUp, true);\n  }\n\n  function onKeyDown(e) {\n    if (e.shiftKey) {\n      slowDownZoom = true;\n      scene.getPanzoom().setZoomSpeed(0.1);\n    } \n  }\n\n  function onKeyUp(e) {\n    if (!e.shiftKey && slowDownZoom) {\n      scene.getPanzoom().setZoomSpeed(1);\n      slowDownZoom = false;\n    }\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/createScene.js","import request from './request';\nimport Progress from './Progress';\n\nlet imageUrl = 'https://edi6jgnosf.execute-api.us-west-2.amazonaws.com/Stage/put_image'\n\nconst productKinds = {\n  mug: '168739066664861503'\n};\n\nfunction getZazzleLink(kind, imageUrl) {\n  const productCode = productKinds[kind];\n  if (!productCode) {\n    throw new Error('Unknown product kind: ' + kind);\n  }\n\n  const imageEncoded = encodeURIComponent(imageUrl);\n  return `https://www.zazzle.com/api/create/at-238058511445368984?rf=238058511445368984&ax=Linkover&pd=${productCode}&ed=true&tc=&ic=&t_map_iid=${imageEncoded}`;\n}\n\nexport default function generateZazzleLink(canvas) {\n  var imageContent = canvas.toDataURL('image/png').replace(/^data:image\\/(png|jpg);base64,/, '');\n  const form = new FormData();\n  form.append('image', imageContent);\n\n  return request(imageUrl, {\n    method: 'POST',\n    responseType: 'json',\n    progress: new Progress(Function.prototype),\n    body: form,\n  }, 'POST').then(x => {\n    if (!x.success) throw new Error('Failed to upload image');\n    let link = x.data.link; \n    return getZazzleLink('mug', link);\n  }).catch(e => {\n    console.log('error', e);\n    throw e;\n  });\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/getZazzleLink.js","<template>\n<div>\n  <find-place v-if='!placeFound' @loaded='onGridLoaded'></find-place>\n  <div id=\"app\">\n    <div v-if='placeFound'>\n      <div class='controls'>\n        <a href=\"#\" class='print-button' @click.prevent='togglePrintWindow'>Customize...</a>\n        <a href=\"#\" class='try-another' @click.prevent='startOver'>Try another city</a>\n      </div>\n      <div v-if='showPrintWindow' class='print-window'>\n        <h3>Display</h3>\n        <div class='row'>\n          <div class='col'>Colors</div>\n          <div class='col colors c-2'>\n            <div class='color-container'>\n              <color-picker v-model='lineColor' @change='updateLinesColor'></color-picker>\n              <div class='color-label'>lines</div>\n            </div>\n\n            <div class='color-container'>\n              <color-picker v-model='backgroundColor' @change='updateBackground'></color-picker>\n              <div class='color-label'>background</div>\n            </div>\n\n            <div class='color-container'>\n              <color-picker v-model='labelColor'></color-picker>\n              <div class='color-label'>labels</div>\n            </div>\n          </div>\n        </div>\n\n        <h3>Export</h3>\n        <div class='row'>\n          <a href='#' @click.prevent='zazzleMugPrint()' class='col'>Onto a mug</a> \n          <span class='col c-2'>\n            Print what you see onto a mug. <br/>Get a unique gift of your favorite city.\n          </span>\n        </div>\n        <div class='row'>\n          <a href='#'  @click.capture='toFile' class='col'>As an image (.png)</a> \n          <span class='col c-2'>\n            Save the current screen as a raster image.\n          </span>\n        </div>\n        <div v-if='isPowerMode' class='row'>\n          <a href='#'  @click.capture='toSVGFile' class='col'>As a vector (.svg)</a> \n          <span class='col c-2'>\n            Save the current screen as a vector image (experimental feature!).\n          </span>\n        </div>\n        <div v-if='false' class='row'>\n          <a href='#' @click.capture='toProtobuf' class='col'>To a .PBF file</a> \n          <span class='col c-2'>\n            Save the current data as a protobuf message. For developer use only.\n          </span>\n        </div>\n\n        <h3>About</h3>\n        <div>\n          <p>This website was created by <a href='https://twitter.com/anvaka' target='_blank'>@anvaka</a>.\n          It downloads roads from OpenStreetMap and renders them with WebGL.\n          </p>\n          <p>\n           You can find the entire <a href='https://github.com/anvaka/city-roads'>source code here</a>. \n           If you love this website you can also <a href='https://www.paypal.com/paypalme2/anvakos/3'>buy me a coffee</a>, but you don't have to!\n          </p>\n        </div>\n      </div>\n      <div class='preview-actions message' v-if='zazzleLink || generatingPreview'>\n          <div v-if='zazzleLink' class='padded popup-help'>\n            If your browser has blocked the new window, <br/>please <a :href='zazzleLink' target='_blank'>click here</a>\n            to open it.\n          </div>\n          <div v-if='generatingPreview' class='loading-container'>\n            <loading-icon></loading-icon>\n            Generating preview url...\n          </div>\n      </div>\n      <editable-label v-model='name' class='city-name' :printable='true' :style='{color: labelColorRGBA}'></editable-label>\n      <div class='license printable' :style='{color: labelColorRGBA}'>data <a href='https://www.openstreetmap.org/about/' target=\"_blank\" :style='{color: labelColorRGBA}'> OpenStreetMap</a></div>\n    </div>\n  </div>\n  </div>\n</template>\n\n<script>\nimport FindPlace from './components/FindPlace';\nimport LoadingIcon from './components/LoadingIcon';\nimport EditableLabel from './components/EditableLabel';\nimport ColorPicker from './components/ColorPicker';\nimport createScene from './lib/createScene';\nimport generateZazzleLink from './lib/getZazzleLink';\nimport appState from './lib/appState';\nimport protobufExport from './lib/protobufExport';\nimport svgExport from './lib/svgExport';\nimport './lib/canvas2BlobPolyfill';\n\n\nlet lastGrid;\n\nexport default {\n  name: 'App',\n  components: {\n    FindPlace,\n    LoadingIcon,\n    EditableLabel,\n    ColorPicker\n  },\n  data() {\n    return {\n      placeFound: false,\n      name: '',\n      zazzleLink: null,\n      generatingPreview: false,\n      showPrintWindow: false,\n      settingsOpen: false,\n      isPowerMode: appState.get('svg'),\n      lineColor: appState.lineColor,\n      labelColor: appState.labelColor,\n      backgroundColor: appState.backgroundColor,\n    }\n  },\n  computed: {\n    labelColorRGBA() {\n      return toRGBA(this.labelColor);\n    }\n  },\n  beforeDestroy() {\n    this.dispose();\n  },\n  methods: {\n    dispose() {\n      if (this.scene) {\n        this.scene.dispose();\n      }\n    },\n    togglePrintWindow() {\n      this.showPrintWindow = !this.showPrintWindow;\n    },\n\n    onGridLoaded(grid) {\n      appState.set('areaId', grid.id)\n      this.placeFound = true;\n      this.name = grid.name.split(',')[0];\n      lastGrid = grid;\n      let canvas = getCanvas();\n      canvas.style.visibility = 'visible';\n\n      this.scene = createScene(grid, canvas);\n    },\n\n    startOver() {\n      appState.unset('areaId');\n      appState.unset('q');\n\n      this.dispose();\n      this.placeFound = false;\n      this.zazzleLink = null;\n      this.showPrintWindow = false;\n      let c =  {r: 0xF7, g: 0xF2, b: 0xE8, a: 1};\n      this.backgroundColor = c;\n      this.lineColor = {r: 22, g: 22, b: 22, a: 1.0};\n      this.labelColor = {r: 22, g: 22, b: 22, a: 1.0};\n\n      document.body.style.backgroundColor = toRGBA(c);\n      getCanvas().style.visibility = 'hidden';\n    },\n\n    toFile(e) {\n      let printableCanvas = this.getPrintableCanvas();\n      let fileName = this.getFileName();\n      printableCanvas.toBlob(function(blob) {\n        let url = window.URL.createObjectURL(blob);\n        let a = document.createElement(\"a\");\n        a.href = url;\n        a.download = fileName + '.png';\n        a.click();\n        window.URL.revokeObjectURL(url);\n      }, 'image/png')\n    },\n\n    toSVGFile(e) { \n      if (!lastGrid) return;\n\n      let visibleRect = this.scene.getProjectedVisibleRect();\n\n      let svg = svgExport(lastGrid, visibleRect);\n      let blob = new Blob([svg], {type: \"image/svg+xml\"});\n      let url = window.URL.createObjectURL(blob);\n      let a = document.createElement(\"a\");\n      a.href = url;\n      a.download = lastGrid.id + '.svg';\n      a.click();\n      window.URL.revokeObjectURL(url);\n    },\n\n    getFileName(extension) {\n      let fileName = ((new Date().toISOString())).replace(/[\\s\\W]/g, '_');\n      return fileName + (extension || '');\n    },\n\n    toProtobuf(e) {\n      if (!lastGrid) return;\n\n      let arrayBuffer = protobufExport(lastGrid);\n      let blob = new Blob([arrayBuffer.buffer], {type: \"application/octet-stream\"});\n      let url = window.URL.createObjectURL(blob);\n      let a = document.createElement(\"a\");\n      a.href = url;\n      a.download = lastGrid.id + '.pbf';\n      a.click();\n      window.URL.revokeObjectURL(url);\n    },\n\n    updateLinesColor() {\n      this.scene.setLineColor(this.lineColor);\n    },\n\n    updateBackground() {\n      this.setBackgroundColor(this.backgroundColor)\n    },\n\n    setBackgroundColor(c) {\n      this.scene.setBackground(c);\n      document.body.style.backgroundColor = toRGBA(c);\n    },\n\n    zazzleMugPrint() {\n      if (this.zazzleLink) {\n        window.open(this.zazzleLink, '_blank');\n        recordOpenClick(this.zazzleLink);\n        return;\n      }\n\n      let printableCanvas = this.getPrintableCanvas();\n\n      this.generatingPreview = true;\n      generateZazzleLink(printableCanvas).then(link => {\n        this.zazzleLink = link;\n        window.open(link, '_blank');\n        recordOpenClick(link);\n        this.generatingPreview = false;\n      }).catch(e => {\n        this.error = e;\n        this.generatingPreview = false;\n      });\n    },\n\n    getPrintableCanvas() {\n      let cityCanvas = getCanvas();\n      let width = cityCanvas.width;\n      let height = cityCanvas.height;\n\n      let printable = document.createElement('canvas');\n      let ctx = printable.getContext('2d');\n      printable.width = width;\n      printable.height = height;\n      this.scene.render();\n      ctx.drawImage(cityCanvas, 0, 0, cityCanvas.width, cityCanvas.height, 0, 0, width, height);\n\n      if (appState.drawLabels) {\n        Array.from(document.querySelectorAll('.printable')).forEach(label => {\n          drawHtml(label, ctx);\n        })\n      }\n\n      return printable;\n    }\n  }\n}\n\nfunction toRGBA(c) {\n    return `rgba(${c.r}, ${c.g}, ${c.b}, ${c.a})`;\n}\n\nfunction drawHtml(element, ctx) {\n  if (!element) return;\n\n  let computedStyle = window.getComputedStyle(element);\n  let bounds = element.getBoundingClientRect();\n  ctx.save();\n  let dpr = window.devicePixelRatio || 1;\n  let fontSize = dpr * Number.parseInt(computedStyle.fontSize, 10);\n\n  ctx.font = fontSize + 'px ' + computedStyle.fontFamily;\n  ctx.fillStyle = computedStyle.color;\n  ctx.textAlign = 'end'\n  ctx.fillText(element.innerText, bounds.right * dpr, bounds.bottom * dpr)\n  ctx.restore();\n}\n\nfunction getCanvas() {\n  return document.querySelector('#canvas')\n}\n\nfunction recordOpenClick(link) {\n  if (typeof ga === 'undefined') return;\n\n  ga('send', 'event', {\n      eventCategory: 'Outbound Link',\n      eventAction: 'click',\n      eventLabel: link\n    });\n}\n</script>\n\n<style lang='stylus'>\n@import('./vars.styl');\n\n#app {\n  margin: 8px;\n  max-height: 100vh;\n  position: absolute;\n  h3 {\n    font-weight: normal;\n  }\n}\n\n.controls {\n  height: 48px;\n  background: white;\n  display: flex;\n  flex-direction: row;\n  align-items: stretch;\n  width: desktop-controls-width;\n  justify-content: space-around;\n  box-shadow: 0 2px 4px rgba(0,0,0,0.2), 0 -1px 0px rgba(0,0,0,0.02);\n\n  a {\n    text-decoration: none;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    color: highlight-color;\n    margin: 0;\n    border: 0;\n    &:hover {\n      color: emphasis-background;\n      background: highlight-color;\n    }\n  }\n  a.try-another {\n    flex: 1;\n  }\n\n  a.print-button {\n    flex: 1;\n    border-right: 1px solid border-color;\n    &:focus {\n      border: 1px dashed highlight-color;\n    }\n  }\n}\n\n.col {\n    display: flex;\n    flex: 1;\n    select {\n      margin-left: 14px;\n    }\n  }\n.row {\n  margin-top: 4px;\n  display: flex;\n  flex-direction: row;\n  min-height: 32px;\n}\n.colors {\n  display: flex;\n  flex-direction: row;\n\n  .color-container {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    width: 64px;\n  }\n\n  .color-label {\n    font-size: 12px;\n  }\n}\n\na {\n  border: 1px solid transparent;\n  margin: -1px;\n  text-decoration: none;\n  color: highlight-color\n}\na:focus {\n  border: 1px dashed highlight-color;\n  outline: none;\n}\n.print-window {\n  max-height: calc(100vh - 48px);\n  overflow-y: auto;\n  border-top: 1px solid border-color;\n  background: white;\n  box-shadow: 0 2px 4px rgba(0,0,0,0.2);\n  width: desktop-controls-width;\n  padding: 8px;\n  .row a {\n    margin-right: 4px;\n  }\n\n  h3 {\n    margin: 8px 0;\n    text-align: right;\n  }\n}\n\n.message {\n  border-top: 1px solid border-color\n  border-bottom: 1px solid border-color\n  background: #F5F5F5;\n}\n\n\n.preview-actions {\n  display: flex;\n  padding: 8px;\n  width: desktop-controls-width;\n  box-shadow: 0 2px 4px rgba(0,0,0,0.2);\n  flex-direction: column;\n  align-items: stretch;\n  font-size: 14px;\n  align-items: center;\n  display: flex;\n\n  .popup-help {\n    text-align: center;\n  }\n}\n\n.city-name {\n  position: fixed;\n  right: 32px;\n  bottom: 54px;\n  font-size: 24px;\n  color: #434343;\n  input {\n    font-size: 24px;\n  }\n}\n\n.license {\n  text-align: right;\n  position: fixed;\n  font-family: labels-font;\n  right: 32px;\n  bottom: 32px;\n  font-size: 12px;\n  padding-right: 8px;\n  a {\n    text-decoration: none;\n    display: inline-block;\n  }\n}\n\n.c-2 {\n  flex: 2\n}\n\n@media (max-width: small-screen) {\n  #app {\n    width: 100%;\n    margin: 0;\n\n    .preview-actions,.error,\n    .controls, .print-window {\n      width: 100%;\n    }\n    .loading-container {\n      font-size: 12px;\n    }\n\n    .license  {\n      right: 8px;\n      bottom: 8px;\n    }\n    .print-window {\n      font-size: 14px;\n    }\n\n    .city-name  {\n      right: 8px;\n      bottom: 24px;\n    }\n  }\n}\n\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/App.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[(!_vm.placeFound)?_c('find-place',{on:{\"loaded\":_vm.onGridLoaded}}):_vm._e(),_vm._v(\" \"),_c('div',{attrs:{\"id\":\"app\"}},[(_vm.placeFound)?_c('div',[_c('div',{staticClass:\"controls\"},[_c('a',{staticClass:\"print-button\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.togglePrintWindow($event)}}},[_vm._v(\"Customize...\")]),_vm._v(\" \"),_c('a',{staticClass:\"try-another\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.startOver($event)}}},[_vm._v(\"Try another city\")])]),_vm._v(\" \"),(_vm.showPrintWindow)?_c('div',{staticClass:\"print-window\"},[_c('h3',[_vm._v(\"Display\")]),_vm._v(\" \"),_c('div',{staticClass:\"row\"},[_c('div',{staticClass:\"col\"},[_vm._v(\"Colors\")]),_vm._v(\" \"),_c('div',{staticClass:\"col colors c-2\"},[_c('div',{staticClass:\"color-container\"},[_c('color-picker',{on:{\"change\":_vm.updateLinesColor},model:{value:(_vm.lineColor),callback:function ($$v) {_vm.lineColor=$$v},expression:\"lineColor\"}}),_vm._v(\" \"),_c('div',{staticClass:\"color-label\"},[_vm._v(\"lines\")])],1),_vm._v(\" \"),_c('div',{staticClass:\"color-container\"},[_c('color-picker',{on:{\"change\":_vm.updateBackground},model:{value:(_vm.backgroundColor),callback:function ($$v) {_vm.backgroundColor=$$v},expression:\"backgroundColor\"}}),_vm._v(\" \"),_c('div',{staticClass:\"color-label\"},[_vm._v(\"background\")])],1),_vm._v(\" \"),_c('div',{staticClass:\"color-container\"},[_c('color-picker',{model:{value:(_vm.labelColor),callback:function ($$v) {_vm.labelColor=$$v},expression:\"labelColor\"}}),_vm._v(\" \"),_c('div',{staticClass:\"color-label\"},[_vm._v(\"labels\")])],1)])]),_vm._v(\" \"),_c('h3',[_vm._v(\"Export\")]),_vm._v(\" \"),_c('div',{staticClass:\"row\"},[_c('a',{staticClass:\"col\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.zazzleMugPrint()}}},[_vm._v(\"Onto a mug\")]),_vm._v(\" \"),_vm._m(0)]),_vm._v(\" \"),_c('div',{staticClass:\"row\"},[_c('a',{staticClass:\"col\",attrs:{\"href\":\"#\"},on:{\"!click\":function($event){return _vm.toFile($event)}}},[_vm._v(\"As an image (.png)\")]),_vm._v(\" \"),_c('span',{staticClass:\"col c-2\"},[_vm._v(\"\\n            Save the current screen as a raster image.\\n          \")])]),_vm._v(\" \"),(_vm.isPowerMode)?_c('div',{staticClass:\"row\"},[_c('a',{staticClass:\"col\",attrs:{\"href\":\"#\"},on:{\"!click\":function($event){return _vm.toSVGFile($event)}}},[_vm._v(\"As a vector (.svg)\")]),_vm._v(\" \"),_c('span',{staticClass:\"col c-2\"},[_vm._v(\"\\n            Save the current screen as a vector image (experimental feature!).\\n          \")])]):_vm._e(),_vm._v(\" \"),(false)?_c('div',{staticClass:\"row\"},[_c('a',{staticClass:\"col\",attrs:{\"href\":\"#\"},on:{\"!click\":function($event){return _vm.toProtobuf($event)}}},[_vm._v(\"To a .PBF file\")]),_vm._v(\" \"),_c('span',{staticClass:\"col c-2\"},[_vm._v(\"\\n            Save the current data as a protobuf message. For developer use only.\\n          \")])]):_vm._e(),_vm._v(\" \"),_c('h3',[_vm._v(\"About\")]),_vm._v(\" \"),_vm._m(1)]):_vm._e(),_vm._v(\" \"),(_vm.zazzleLink || _vm.generatingPreview)?_c('div',{staticClass:\"preview-actions message\"},[(_vm.zazzleLink)?_c('div',{staticClass:\"padded popup-help\"},[_vm._v(\"\\n            If your browser has blocked the new window, \"),_c('br'),_vm._v(\"please \"),_c('a',{attrs:{\"href\":_vm.zazzleLink,\"target\":\"_blank\"}},[_vm._v(\"click here\")]),_vm._v(\"\\n            to open it.\\n          \")]):_vm._e(),_vm._v(\" \"),(_vm.generatingPreview)?_c('div',{staticClass:\"loading-container\"},[_c('loading-icon'),_vm._v(\"\\n            Generating preview url...\\n          \")],1):_vm._e()]):_vm._e(),_vm._v(\" \"),_c('editable-label',{staticClass:\"city-name\",style:({color: _vm.labelColorRGBA}),attrs:{\"printable\":true},model:{value:(_vm.name),callback:function ($$v) {_vm.name=$$v},expression:\"name\"}}),_vm._v(\" \"),_c('div',{staticClass:\"license printable\",style:({color: _vm.labelColorRGBA})},[_vm._v(\"data \"),_c('a',{style:({color: _vm.labelColorRGBA}),attrs:{\"href\":\"https://www.openstreetmap.org/about/\",\"target\":\"_blank\"}},[_vm._v(\" OpenStreetMap\")])])],1):_vm._e()])],1)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('span',{staticClass:\"col c-2\"},[_vm._v(\"\\n            Print what you see onto a mug. \"),_c('br'),_vm._v(\"Get a unique gift of your favorite city.\\n          \")])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('p',[_vm._v(\"This website was created by \"),_c('a',{attrs:{\"href\":\"https://twitter.com/anvaka\",\"target\":\"_blank\"}},[_vm._v(\"@anvaka\")]),_vm._v(\".\\n          It downloads roads from OpenStreetMap and renders them with WebGL.\\n          \")]),_vm._v(\" \"),_c('p',[_vm._v(\"\\n           You can find the entire \"),_c('a',{attrs:{\"href\":\"https://github.com/anvaka/city-roads\"}},[_vm._v(\"source code here\")]),_vm._v(\". \\n           If you love this website you can also \"),_c('a',{attrs:{\"href\":\"https://www.paypal.com/paypalme2/anvakos/3\"}},[_vm._v(\"buy me a coffee\")]),_vm._v(\", but you don't have to!\\n          \")])])}]\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-4815b5ed\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/App.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-4815b5ed\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!stylus-loader?{\\\"sourceMap\\\":true}!../node_modules/vue-loader/lib/selector?type=styles&index=0!./App.vue\")\n}\nvar normalizeComponent = require(\"!../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../node_modules/vue-loader/lib/selector?type=script&index=0!./App.vue\"\nimport __vue_script__ from \"!!babel-loader!../node_modules/vue-loader/lib/selector?type=script&index=0!./App.vue\"\n/* template */\nimport __vue_template__ from \"!!../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-4815b5ed\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../node_modules/vue-loader/lib/selector?type=template&index=0!./App.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/App.vue\n// module id = null\n// module chunks = ","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _vm._m(0)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"absolute no-webgl\"},[_c('h3',[_vm._v(\"WebGL is not enabled :(\")]),_vm._v(\" \"),_c('p',[_vm._v(\"This website renders millions of roads at once.\")]),_vm._v(\" \"),_c('p',[_vm._v(\"\\n    To render this amount of data fast, the website uses \"),_c('a',{attrs:{\"href\":\"https://get.webgl.org/\"}},[_vm._v(\"WebGL\")]),_vm._v(\",\\n    which seem to be not supported by the device that you are using.\\n  \")]),_vm._v(\" \"),_c('p',[_vm._v(\"Please try a different device to play with this website\")]),_vm._v(\" \"),_c('img',{attrs:{\"src\":\"https://i.imgur.com/Fbbe5a6.png\",\"alt\":\"demo\"}})])}]\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-4c133b01\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/NoWebGL.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-4c133b01\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!stylus-loader?{\\\"sourceMap\\\":true}!../node_modules/vue-loader/lib/selector?type=styles&index=0!./NoWebGL.vue\")\n}\nvar normalizeComponent = require(\"!../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nvar __vue_script__ = null\n/* template */\nimport __vue_template__ from \"!!../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-4c133b01\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../node_modules/vue-loader/lib/selector?type=template&index=0!./NoWebGL.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-4c133b01\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/NoWebGL.vue\n// module id = null\n// module chunks = ","// The Vue build version to load with the `import` command\n// (runtime-only or standalone) has been set in webpack.base.conf with an alias.\nimport Vue from 'vue'\nimport App from './App'\nimport NoWebGL from './NoWebGL'\nconst wgl = require('w-gl');\n\nVue.config.productionTip = false\n\nif (wgl.isWebGLEnabled(document.querySelector('#canvas'))) {\n  /* eslint-disable no-new */\n  new Vue({\n    el: '#app',\n    components: { App },\n    template: '<App/>'\n  })\n} else {\n  new Vue({\n    el: '#app',\n    components: { NoWebGL },\n    template: '<NoWebGL/>'\n  })\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/main.js","/*\n * JavaScript Canvas to Blob\n * https://github.com/blueimp/JavaScript-Canvas-to-Blob\n *\n * Copyright 2012, Sebastian Tschan\n * https://blueimp.net\n *\n * Licensed under the MIT license:\n * https://opensource.org/licenses/MIT\n *\n * Based on stackoverflow user Stoive's code snippet:\n * http://stackoverflow.com/q/4998908\n */\n\n/* global define, Uint8Array, ArrayBuffer, module */\n\n;(function(window) {\n  'use strict'\n\n  var CanvasPrototype =\n    window.HTMLCanvasElement && window.HTMLCanvasElement.prototype\n  var hasBlobConstructor =\n    window.Blob &&\n    (function() {\n      try {\n        return Boolean(new Blob())\n      } catch (e) {\n        return false\n      }\n    })()\n  var hasArrayBufferViewSupport =\n    hasBlobConstructor &&\n    window.Uint8Array &&\n    (function() {\n      try {\n        return new Blob([new Uint8Array(100)]).size === 100\n      } catch (e) {\n        return false\n      }\n    })()\n  var BlobBuilder =\n    window.BlobBuilder ||\n    window.WebKitBlobBuilder ||\n    window.MozBlobBuilder ||\n    window.MSBlobBuilder\n  var dataURIPattern = /^data:((.*?)(;charset=.*?)?)(;base64)?,/\n  var dataURLtoBlob =\n    (hasBlobConstructor || BlobBuilder) &&\n    window.atob &&\n    window.ArrayBuffer &&\n    window.Uint8Array &&\n    function(dataURI) {\n      var matches,\n        mediaType,\n        isBase64,\n        dataString,\n        byteString,\n        arrayBuffer,\n        intArray,\n        i,\n        bb\n      // Parse the dataURI components as per RFC 2397\n      matches = dataURI.match(dataURIPattern)\n      if (!matches) {\n        throw new Error('invalid data URI')\n      }\n      // Default to text/plain;charset=US-ASCII\n      mediaType = matches[2]\n        ? matches[1]\n        : 'text/plain' + (matches[3] || ';charset=US-ASCII')\n      isBase64 = !!matches[4]\n      dataString = dataURI.slice(matches[0].length)\n      if (isBase64) {\n        // Convert base64 to raw binary data held in a string:\n        byteString = atob(dataString)\n      } else {\n        // Convert base64/URLEncoded data component to raw binary:\n        byteString = decodeURIComponent(dataString)\n      }\n      // Write the bytes of the string to an ArrayBuffer:\n      arrayBuffer = new ArrayBuffer(byteString.length)\n      intArray = new Uint8Array(arrayBuffer)\n      for (i = 0; i < byteString.length; i += 1) {\n        intArray[i] = byteString.charCodeAt(i)\n      }\n      // Write the ArrayBuffer (or ArrayBufferView) to a blob:\n      if (hasBlobConstructor) {\n        return new Blob([hasArrayBufferViewSupport ? intArray : arrayBuffer], {\n          type: mediaType\n        })\n      }\n      bb = new BlobBuilder()\n      bb.append(arrayBuffer)\n      return bb.getBlob(mediaType)\n    }\n  if (window.HTMLCanvasElement && !CanvasPrototype.toBlob) {\n    if (CanvasPrototype.mozGetAsFile) {\n      CanvasPrototype.toBlob = function(callback, type, quality) {\n        var self = this\n        setTimeout(function() {\n          if (quality && CanvasPrototype.toDataURL && dataURLtoBlob) {\n            callback(dataURLtoBlob(self.toDataURL(type, quality)))\n          } else {\n            callback(self.mozGetAsFile('blob', type))\n          }\n        })\n      }\n    } else if (CanvasPrototype.toDataURL && dataURLtoBlob) {\n      CanvasPrototype.toBlob = function(callback, type, quality) {\n        var self = this\n        setTimeout(function() {\n          callback(dataURLtoBlob(self.toDataURL(type, quality)))\n        })\n      }\n    }\n  }\n  if (typeof define === 'function' && define.amd) {\n    define(function() {\n      return dataURLtoBlob\n    })\n  } else if (typeof module === 'object' && module.exports) {\n    module.exports = dataURLtoBlob\n  } else {\n    window.dataURLtoBlob = dataURLtoBlob\n  }\n})(window)\n\n\n// WEBPACK FOOTER //\n// ./src/lib/canvas2BlobPolyfill.js","var place = require('../proto/place.js').place;\n\nmodule.exports = function svgExport(grid, rect) {\n  let ways = [];\n  let date = (new Date()).toISOString();\n  let svgDoc = [\n`<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<!-- Generator: https://github.com/anvaka/city-roads\nData  OpenStreetMap contributors, ODbL 1.0. https://osm.org/copyright\n-->\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n   viewBox=\"${rect.left} ${rect.top} ${rect.width} ${rect.height}\">\n<g id=\"paths\" fill=\"none\" stroke=\"#000000\">`\n  ]\n\n  let positions = grid.nodes;\n  let project = grid.getProjector();\n  grid.forEachElement(x => {\n    if (x.type !== 'way') {\n      return;\n    }\n    let prev = null;\n    let hasLine = false;\n    let points = x.nodes.map(node => {\n      let pt = project(positions.get(node));\n      if (isOutside(pt, rect)) {\n        prev = null;\n        return;\n      }\n\n      let prefix = prev === null ? 'M' : 'L'\n      let shouldAddPrefix = (prefix !== prev);\n      if (prefix === 'L') hasLine = true;\n      prev = prefix;\n\n      return `${shouldAddPrefix ? prefix : ''}${pt.x},${pt.y} `;\n    }).filter(x => x).join(' ')\n\n    if (hasLine) {\n      svgDoc.push(`<path d=\"${points}\" />`);\n    }\n  });\n  svgDoc.push(`</g></svg>`)\n\n  return svgDoc.join('\\n');\n}\n\nfunction isOutside(point, rect) {\n  return point.x < rect.left || point.x > rect.right ||\n         point.y < rect.top || point.y > rect.bottom;\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/svgExport.js"],"sourceRoot":""}